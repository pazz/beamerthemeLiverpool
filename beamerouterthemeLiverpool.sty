\mode<presentation>
% draw two bricks
%
% \uolbrick[pos1][pos2][style1][style2]{content1}{content2} % where
% style1: additional tikz styles for brick 1
% style2: additional tikz styles for brick 2
% pos1: relative position on node 1 where node 2 is placed
% pos2: anchor of node 2
% content: text to be placed in the brick.
% Only content is mandatory.
% For example, \uolbrick[south west][north west][red][green]{Red bricks are cool}{Green Brick}
%
\NewDocumentCommand{\uolbricks}{ O{} O{} O{south} O{north west} m m }{
  \begin{tikzpicture}[brick/.style={outer sep=0pt,draw=fg,align=left}]
      \node[brick,anchor=east,#1] (top) at (0,0){#5};
      \node[brick,anchor=#4,#2] (below) at (top.#3){#6};
  \end{tikzpicture}
}

% Draw a single brick
% arguments as above but only style1 and content1
\NewDocumentCommand{\uolbrick}{O{} m }{
  \begin{tikzpicture}[brick/.style={outer sep=0pt,draw=fg,align=left}]
      \node[brick,#1] (top) at (0,0){#2};
  \end{tikzpicture}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BACKGROUND CANVAS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\defbeamertemplate*{background}{image right}[1][UoL-vg.jpg]{
  % only change first slide, rest defaults to single colour (normal text.bg)
  \ifnum\thepage=1\relax%
  \begin{tikzpicture}
  \useasboundingbox (0,0) rectangle(\the\paperwidth,\the\paperheight);
  \fill[color=title.bg] (0,0) rectangle (\the\paperwidth,\the\paperheight);
  \path[fill overzoom image=#1] (\the\paperwidth*0.66,0) rectangle(\the\paperwidth,\the\paperheight);
  \end{tikzpicture}
  \fi
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TITLE PAGE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% TITLE PAGE COLORS
\setbeamercolor*{title}{bg=Blue,fg=White}
\setbeamercolor*{date}{parent=title,bg=}
\setbeamercolor*{author}{parent=title,bg=}
\setbeamercolor*{institute}{parent=title,bg=}


% TITLE PAGE LAYOUT
\defbeamertemplate*{title page}{Liverpool}[1][]{%
    \begin{beamercolorbox}{institute}
    % UOL logo top left
    \tikz[baseline=0pt] {
        \node[anchor=west,inner sep=0pt] (X) at (0,0) {
    \includegraphics[width=0.22\paperwidth]{UoL-Logo-White.png}};
    }
    % Department info (short institute) if not emppty top right
    \ifx\beamer@shortinstitute\@empty
      \hfill %X\insertinstituteX\insertshortinstitute
    \else%
     \hfill
      \usebeamerfont{institute}\colorbox{fg}{\mbox{\strut}} \insertshortinstitute
    \fi%     
    \end{beamercolorbox}

   \vskip2cm%
    { % simulate a beamercolorbox but without the extra space
    \usebeamerfont{title}
    \usebeamercolor{title}
    \color{fg}
    %
    % Display title+subtitle as brickpile if subtitle is defined
    \ifx\insertsubtitle\@empty%
        \uolbrick{\inserttitle}\par%
    \else % Display title as single brick otherwise
        \uolbricks[font=\bf]{\inserttitle}{\insertsubtitle}
    \fi%
    }
   \vskip0.75cm%
   \vfill
   \begin{beamercolorbox}{author}
     \usebeamerfont{author}\insertauthor%
   \end{beamercolorbox}
   \begin{beamercolorbox}[]{date}
     \usebeamerfont{author}\insertdate%
   \end{beamercolorbox}
}

% FRAME TITLE
\defbeamertemplate*{frametitle}{Liverpool}[1][]
{
\vskip0.5cm%
   \ifx\insertframesubtitle\@empty%
      \usebeamercolor[fg]{frametitle}
      \uolbrick[font=\bf]{\insertframetitle}
   \else%
       \usebeamercolor[fg]{framesubtitle}
       \uolbricks[font=\bf]{\insertframetitle}{\insertframesubtitle}
   \fi
\vskip0.3cm%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% COLOUR PROFILES
%
% The implementation follows
% https://tex.stackexchange.com/questions/257300/passing-arguments-to-custom-frame-option
% 
% TODO: do not reset to defaults unless parameter was used?
% That way one could set the colours once per pgfkeys and it's valid for multiple frames.
% metropolis/moloch do this.

% reset the colour profile back to defaults when starting a new frame
\BeforeBeginEnvironment{frame}{%
    \pgfkeys{/uol/color/style=default}
}
% define colourprofile argument and use it to set the profile
\makeatletter
\define@key{beamerframe}{colourprofile}[true]{%
    \pgfkeys{/uol/color/style={#1}}
}
\makeatother


\mode<all>
